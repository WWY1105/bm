<div class="container contents bg-white">
  <!---->
  <div class="row" id="member">
    <ul class="nav nav-tabs">
      <li role="presentation" class="active"><a ng-class="{'bg-grey':!view.state}"><strong>会员等级设定 </strong>
        <button class="btn btn-primary btn-xs" ng-show="!view.state">已停用</button>
      </a></li>
      <li class="pull-right">
        <button class="btn rule-add-btn" ng-hide="view.state" ng-click="addnewFn()">
          <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>添加会员等级
        </button>
        <button class="btn rule-stop-btn" data-target="#turnon" data-toggle="modal" ng-hide="view.state">启用会员计划</button>
        <button class="btn rule-stop-btn" data-target="#turnoff" data-toggle="modal" ng-show="view.state">停用会员计划
        </button>
      </li>
    </ul>
    <table id="upgrade-table" class="table" ng-class="{'bg-grey':!view.state,'table-striped':view.state}">
      <tr ng-repeat="members in view.member" ng-click="view.member.edit=$index">
        <td ng-class="{'bg-grey':!view.state}" class="vertical-middle">
          <div class="radius-through">
            <div class="radius"></div>
          </div>
          <div class="radius-text"><span class="orange-radius">{{members.toGrade}}</span>{{members.toName}}</div>
        </td>
        <td>
          <ul>
            <li ng-repeat="strategy in members.strategies">
              <span class="text-orange">●</span> {{strategy}}
            </li>
          </ul>
        </td>
        <td class="click rule-edit" ng-hide="view.state" ng-click="showFn(members.toGrade)">
          <!--ng-show="view.member.edit==$index"-->
          <div><span
                  class="glyphicon glyphicon-edit" aria-hidden="true"></span>修改规则
          </div>
        </td>
      </tr>
    </table>
    <div class="text-right">* 停用后才可添加和修改规则</div>
    <!---->
  </div>
</div>
<!--修改和添加策略-->
<div id="memberedit" ng-class="{'opacity':!plan.add}" class="modal fade addpanel" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" style="overflow:hidden">
      <div class="modal-header">
        <span ng-bind="'会员等级'"></span>
        <button type="button" class="close" data-dismiss="modal" ng-click="closeModal()">
          <span aria-hidden="true" class="text-orange">×</span>
          <span class="sr-only">Close</span>
        </button>
      </div>
      <div class="oval-tag" ng-show="plan.add"><span class="bg-white">1</span><span class="bg-orange">2</span></div>
      <form class="form-horizontal" ng-submit="postSend()" name="add_form">
        <div class="ruleadd">
          <div class="col-sm-2 text-right">
            <span class="title">名称 :</span>
          </div>
          <div class="col-sm-10 content2 mb0">
            <input type="text" class="form-control col-sm-5" ng-show="!plan.add" ng-model="view.show.toName"/>
            <button class="btn bg-black btn-primary col-sm-2" ng-hide="!plan.add">{{view.show.toName}}</button>
          </div>
        </div>
        <div class="ruleadd">
          <div class="col-sm-2 text-right">
            <span class="title"><span class="text-red">*</span>购买 :</span>
          </div>
          <div class="col-sm-10 content2 mb0">
            <div class="form-group mb22">
              <div class="form-control-static pull-left">
                花费
              </div>
              <div class="col-sm-3">
                <input type="number" min="0" class="form-control" ng-model="posts.BUY.value"/>
              </div>
              <div class="form-control-static pull-left">
                元，从
                <strong ng-bind="view.member[view.show.toGrade-2].toName||'一般顾客'"></strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
            <div class="form-group mb22" ng-if="view.member[view.show.toGrade-1].toGrade > 1">
              <div class="form-control-static pull-left">花费
              </div>
              <div class=" col-sm-5">
                <input type="number" min="0" class="form-control" ng-model="posts.BUY.special_value"/>
              </div>
              <div class="form-control-static pull-left">
                元，从
                <strong>一般顾客</strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
          </div>
        </div>
        <div class="out ruleadd">
          <div class="col-sm-2 text-right ">
            <span class="title">其他 :</span>
          </div>
          <div class="col-sm-10 mb0" ng-class="{'content2':view.show.toGrade-1==0||'content'}">
            <div class="form-group mb22">
              <div class="checkbox pull-left">
                <label>
                  <input type="checkbox" ng-model="check.POINT_EXCHANGE">积分兑换</label>
                <label>
                  <input type="checkbox" ng-model="check.POINT" value="option1">累积积分升级</label>
                <label>
                  <input type="checkbox" ng-model="check.CHARGE">充值</label>
                <label ng-show="view.show.toGrade===1">
                  <input type="checkbox" ng-model="check.FREE" ng-change="posts.FREE=check.FREE?{}:undefined"/> 免费升级
                </label>
              </div>
            </div>
            <div class="form-group mb22" ng-if="check.POINT_EXCHANGE">
              <div class="form-control-static pull-left">兑换</div>
              <div class=" col-sm-4">
                <input type="number" min="0" class="form-control" ng-model="posts.POINT_EXCHANGE.value"/>
              </div>
              <div class="form-control-static pull-left">
                积分，从
                <strong ng-bind="view.member[view.show.toGrade-2].toName||'一般顾客'"></strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
            <div class="form-group mb22" ng-if="check.POINT_EXCHANGE&&view.member[view.show.toGrade-1].toGrade > 1">
              <div class="form-control-static pull-left">兑换</div>
              <div class=" col-sm-4">
                <input type="number" min="0" class="form-control" ng-model="posts.POINT_EXCHANGE.special_value.value"/>
              </div>
              <div class="form-control-static pull-left">
                积分，从
                <strong>一般顾客</strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
            <div class="form-group mb22" ng-if="check.POINT">
              <div class="form-control-static pull-left">累积</div>
              <div class=" col-sm-4">
                <input type="number" min="0" class="form-control" ng-model="posts.POINT.value"/>
              </div>
              <div class="form-control-static pull-left">
                积分，从
                <strong>一般顾客</strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
            <div class="form-group mb22" ng-if="check.CHARGE">
              <div class="form-control-static pull-left">
                充值
              </div>
              <div class=" col-sm-4">
                <input type="number" min="0" class="form-control" ng-model="posts.CHARGE.value" />
              </div>
              <div class="form-control-static pull-left">
                元，从
                <strong ng-bind="view.member[view.show.toGrade-2].toName||'一般顾客'"></strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
            <div class="form-group mb22" ng-if="check.CHARGE&&view.member[view.show.toGrade-1].toGrade > 1">
              <div class="form-control-static pull-left">
                充值
              </div>
              <div class=" col-sm-4">
                <input type="number" min="0" class="form-control" ng-model="posts.CHARGE.special_value"/>
              </div>
              <div class="form-control-static pull-left">
                元，从
                <strong>一般顾客</strong> 升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
            <div class="form-group mb22">
              <div class="form-control-static pull-left" ng-if="posts.FREE">
                从
                <strong>一般顾客</strong> 免费升级到
                <strong ng-bind="view.member[view.show.toGrade-1].toName"></strong>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-10 col-sm-offset-2">
          <div class="row mb15">
            <div class="col-sm-3">
              <a data-dismiss="modal" class="btn btn-default btn-block">返回</a>
            </div>
            <div class="col-sm-3 col-sm-offset-1">
              <button class="btn btn-primary btn-block" type="submit" ng-disabled="!add_form.$valid"
                      disabled="disabled">确定
              </button>
            </div>
          </div>
        </div>
      </form>
      <!--</div>-->
      <!--</div>-->
      <!--</div>-->
    </div>
  </div>

</div>
<!--增加名称-->
<div id="memberadd" class="modal fade addpanel" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <form name="planform">
      <div class="modal-content" style="overflow:hidden">
        <div class="modal-header">
          <span ng-bind="'添加会员等级'"></span>
          <button type="button" class="close " data-dismiss="modal" ng-click="closeModal()">
            <span aria-hidden="true" class="text-orange">×</span>
            <span class="sr-only">Close</span>
          </button>
          <h4 class="modal-title" id="mySmallModalLabel" ng-bind="modal.title"></h4>
        </div>
        <div class="oval-tag"><span class="bg-orange">1</span><span class="bg-white">2</span></div>
        <div class="modal-body">
          <div class="form-horizontal">
            <div class="form-group mb0">
              <label class="col-sm-3 control-label"><span class="text-red">*</span> 名称:</label>

              <div class="col-sm-5">
                <input class="form-control" name="memberName" ng-model="tem.name" type="text" placeholder="输入该级别的名称"
                       ng-minlength='2' ng-maxlength='10' ng-pattern="/[\u4e00-\u9fa5\d\w]/" required/>

                <div class="help-block ">
                  <div class="" ng-show="!planform.memberName.$valid&&!planform.memberName.$touched">2-10个字符</div>
                                <span ng-messages="planform.memberName.$error" ng-show="planform.memberName.$touched">
                                    <div class="text-red" ng-message="minlength">至少需要2个字符</div>
                                    <div class="text-red" ng-message="maxlength">需小于10字符</div>
                                    <div class="text-red" ng-message="pattern">
                                      <span ng-bind="config.textCheckErrorJson.nickname"></span>
                                    </div>
                            <div class="text-red" ng-message="required">2-20字符的汉字英文数字</div>
                            </span>

                  <div class="text-success" ng-show="planform.memberName.$valid">输入正确</div>
                </div>
              </div>
              <div class="col-sm-3"><a class="btn btn-primary btn-block" ng-disabled="!planform.$valid"
                                       ng-click="handleClick(view.plan.level)">下一步</a></div>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
<!--启用停用计划-->
<div id="turnoff" class="modal fade addpanel" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" style="overflow:hidden">
      <div class="modal-header">
        <span>停用会员计划</span>
        <button type="button" class="close text-orange" data-dismiss="modal" ng-click="closeModal()">
          <span aria-hidden="true">×</span>
          <span class="sr-only">Close</span>
        </button>
      </div>
      <div class="modal-body marb15">
        <div class="row">
          <div class="col-sm-2 col-sm-offset-3">
            <img src="/public/img/know.png">
          </div>
          <div class="col-sm-7 mt15"><span>贵店已有顾客加入会员<br/>请谨慎选择是否停用会员计划</span>
          </div>
        </div>
      </div>
      <div class="ruleadd">
        <div class="row">
          <div class="col-sm-3 col-sm-offset-3">
            <a class="btn btn-primary btn-block" data-loading-text="Loading..." ng-click="switchStatus(false)">确认停用</a>
          </div>
          <div class="col-sm-3">
            <a data-dismiss="modal" class="btn bg-black btn-block btn-primary">以后再说</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--停用计划-->
<div id="turnon" class="modal fade addpanel" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" style="overflow:hidden">
      <div class="modal-header">
        <span>启用会员计划</span>
        <button type="button" class="close text-orange" data-dismiss="modal" ng-click="closeModal()">
          <span aria-hidden="true">×</span>
          <span class="sr-only">Close</span>
        </button>
      </div>
      <div class="modal-body marb15">
        <div class="row">
          <div class="col-sm-2 col-sm-offset-3">
            <img src="/public/img/question.png">
          </div>
          <div class="col-sm-7 mt20"><span>确认启用会员计划吗？</span>
          </div>
        </div>
      </div>
      <div class="ruleadd">
        <div class="row">
          <div class="col-sm-3 col-sm-offset-3">
            <a class="btn btn-primary btn-block" data-loading-text="Loading..." ng-click="switchStatus(true)">确认启用</a>
          </div>
          <div class="col-sm-3">
            <a data-dismiss="modal" class="btn bg-black btn-block btn-primary">以后再说</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--<div id="turnoff" class="modal fade addpanel" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"-->
<!--aria-hidden="true">-->
<!--<div class="modal-dialog">-->
<!--<div class="modal-content" style="overflow:hidden">-->
<!--<div class="modal-header">-->
<!--<span>禁用会员计划</span>-->
<!--<button type="button" class="close" data-dismiss="modal" ng-click="closeModal()">-->
<!--<span aria-hidden="true">×</span>-->
<!--<span class="sr-only">Close</span>-->
<!--</button>-->
<!--</div>-->
<!--<div class="modal-body">-->
<!--<div class="form-horizontal">-->

<!--</div>-->
<!--</div>-->
<!--</div>-->
<!--</div>-->
<!--</div>-->